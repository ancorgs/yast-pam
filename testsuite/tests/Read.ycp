/**
 * Read.ycp
 * Testing PamSettings read functions
 * Jiri Suchomel <jsuchome@suse.cz>
 *
 * $Id$
 */

{

    include "testsuite.ycp";
    import "PamSettings";

    map READ = $[
	"etc": $[
	    "krb5_conf" : $[],
	    "security": $[
		"section": $[
		    "/etc/security/pam_unix2.conf": $[
			"passwd" : "nullok use_ldap"
		    ],
		    "/etc/security/pam_pwcheck.conf": $[
			"passwd" : "nullok"
		    ]
		],
		"v": $[
		    "/etc/security/pam_unix2.conf": $[
			"passwd" : "nullok use_ldap",
			"auth"	: nil
		    ],
		]
	    ]
	]
    ];

    DUMP ("==== PamSettings::GetFiles: =============================");

    TEST(``(PamSettings::GetFiles ()), [ READ, [], [] ], 0);

    DUMP ("==== PamSettings::GetValues (\"unix2\", \"passwd\") =====");

    TEST(``(PamSettings::GetValues ("unix2", "passwd")), [ READ, [], [] ], 0);

    TEST(``(PamSettings::GetValues ("unix2", "auth")), [ READ, [], [] ], 0);

}
